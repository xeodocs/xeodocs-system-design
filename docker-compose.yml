services:
  starlight:
    build:
      dockerfile: .astro-starlight/Dockerfile.starlight
    ports:
      - "12000:4321"
    volumes:
      - ./system-design:/app/src/content/docs
    restart: unless-stopped
  spec-server:
    image: python:3-alpine
    ports:
      - "12001:8080"
    volumes:
      - ./api-design:/app
    working_dir: /app
    command: python server.py
    environment:
      - PYTHONUNBUFFERED=1

  swagger-ui:
    image: swaggerapi/swagger-ui:v5.17.14
    ports:
      - "12002:8080"
    environment:
      - SWAGGER_JSON_URL=http://localhost:12001/${OPENAPI_FILE}
    depends_on:
      - spec-server
    restart: unless-stopped

  redoc:
    image: redocly/redoc
    ports:
      - "12003:80"
    environment:
      - SPEC_URL=http://localhost:12001/${OPENAPI_FILE}
    depends_on:
      - spec-server
    restart: unless-stopped
